# Простая инструкция по деплою ProtekAutoCMS через Portainer

## 1. Подготовка файлов

Убедитесь, что у вас есть следующие файлы:
- `Dockerfile`
- `docker-compose.yml`
- `stack.env`
- `docker-entrypoint.sh`

## 2. Настройка переменных окружения

Отредактируйте файл `stack.env`, указав правильные значения для:
- `DATABASE_URL` - строка подключения к вашей базе данных
- `NEXTAUTH_URL` - URL вашего сайта
- `NEXT_PUBLIC_API_URL` - URL вашего API (обычно совпадает с URL сайта)

## 3. Деплой через Portainer

1. Загрузите все файлы проекта на сервер, включая:
   - `Dockerfile`
   - `docker-compose.yml`
   - `stack.env`
   - `docker-entrypoint.sh`
   - Все файлы исходного кода

2. В Portainer выберите "Stacks" > "Add stack"

3. Загрузите `docker-compose.yml` или вставьте его содержимое

4. Убедитесь, что Portainer видит файл `stack.env`

5. Нажмите "Deploy the stack"

## 4. Первый запуск

При первом запуске контейнер автоматически:
- Установит зависимости
- Сгенерирует Prisma клиент
- Соберет приложение
- Запустит миграции базы данных

Это может занять несколько минут. Следите за логами контейнера в Portainer.

## 5. Проверка деплоя

После деплоя проверьте:
- Контейнер запущен и работает
- Сайт доступен по указанному домену

## 6. Устранение проблем

Если возникают проблемы при запуске:
1. Проверьте логи контейнера в Portainer
2. Убедитесь, что все переменные окружения корректны
3. Проверьте соединение с базой данных

## 7. Обновление приложения

Для обновления приложения:
1. Загрузите новые файлы исходного кода на сервер
2. В Portainer нажмите "Redeploy the stack" 